<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
<form action="/updateDaniBox" method='POST'>
    Intensidad <input id='brightness' type='range' name='brightness' min='0' max='1' step='0.01' value='0.5'> <br>
    Órden <select id='sectionOrder' name='sectionOrder'>
        <option value='backToFront'>Atrás hacia adelante</option>
        <option value='leftToRight'>Izquierda a derecha</option>
        <option value='topToBottom'>Arriba hacia abajo</option>
    </select><br>
    Patrón <select id='funName' name='funName'>
        <option value='rainbowCycle'>Arcoíris por secciones</option>
        <option value='rainbowCycleAll'>Arcoíris</option>
        <option value='pingpongAll'>Ping Pong entre dos colores</option>
        <option value='pingpongSections'>Ping pong por secciones</option>
        <option value='colorAll'>Un color</option>
        <option value='colorSections'>Color por secciones</option>
    </select><br>
    Colores de inicio:<input class='startColor' type='color' name='color1' value='#FF0000'>
    <input class='startColor' type='color' name='color2' value='#AA0000'>
    <input class='startColor' type='color' name='color3' value='#880000'><br>
    Colores finales:<input class='endColor' type='color' name='color1' value='#FF0000'>
    <input class='endColor' type='color' name='color2' value='#AA0000'>
    <input class='endColor' type='color' name='color3' value='#880000'><br>
    Lento <input id='speed' type='range' name='speed' min='1000' max='11000' step='2000' value='2500'>Rápido<br>
    <button type='button' onclick='toFunction()'>Mandar</button>
</form>
<script>
    function toFunction(){
        brightness = $("#brightness").val();
        sectionOrder = $("#sectionOrder").val();
        funName = $('#funName').val();
        speed = $('#speed').val();
        startColor = [];
        $('.startColor').each((i, el) => {
            startColor.push(hexToRgb($(el).val()));
        });
        endColor = [];
        $('.endColor').each((i, el) => {
            endColor.push(hexToRgb($(el).val()));
        });
        dataToSend = {'brightness':brightness, 'sectionOrder': sectionOrder,
    'funName': funName, 'startColor': startColor, 'endColor': endColor, 'speed': speed};
        $.ajax({
            url:            '/updateDaniBox',
            type:           'POST',
            contentType:    'application/json',
            data: JSON.stringify(dataToSend)
        });
        console.log(JSON.stringify(dataToSend));
    }
    function hexToRgb(hex) {
        var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        return result ? [
        parseInt(result[1], 16),
        parseInt(result[2], 16),
        parseInt(result[3], 16)
        ] : null;
    }
</script>
</body>
</html>